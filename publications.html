---
layout: page
title: Publications
category: page
main_nav: true
permalink: /publications/
---

<div id="publications-list">
  <p>Loading publications from ORCID...</p>
</div>

<script>
const ORCID_ID = "0000-0001-8746-8754";
const container = document.getElementById('publications-list');

if (!ORCID_ID) {
  container.innerHTML = '<p>ORCID ID not configured in _config.yml</p>';
} else {
  fetch(`https://pub.orcid.org/v3.0/${ORCID_ID}/works`, {
    method: 'GET',
    headers: {
      'Accept': 'application/json'
    }
  })
  .then(response => {
    if (!response.ok) {
      throw new Error(`HTTP ${response.status}: ${response.statusText}`);
    }
    return response.json();
  })
  .then(data => {
    if (!data?.group || !Array.isArray(data.group)) {
      container.innerHTML = '<p>No publications found.</p>';
      return;
    }

    let html = '<ul style="list-style: none; padding-left: 0;">';
    let foundAny = false;

    data.group.forEach(group => {
      if (!group?.['work-summary'] || group['work-summary'].length === 0) return;
      
      const work = group['work-summary'][0];

      // --- Title ---
      const title = work.title?.title?.value || 'Untitled';

      // --- Year ---
      const year = work['publication-date']?.year?.value || 'n.d.';

      // --- URL (prefer work.url, fallback to DOI from external-ids) ---
      let url = work.url || '#';
      if (url === '#' && work['external-ids']?.['external-id']) {
        // Find DOI
        const doi = work['external-ids']['external-id'].find(id =>
          id['external-id-type'] === 'doi' && id['external-id-value']
        );
        if (doi) {
          url = `https://doi.org/${doi['external-id-value']}`;
        }
      }

      // --- Authors ---
      let authors = 'Unknown authors';
      if (work.contributors?.contributor && Array.isArray(work.contributors.contributor)) {
        authors = work.contributors.contributor
          .map(c => {
            // credit-name may not exist; fallback to inferred credit_name path
            const creditName = c?.['credit-name']?.value;
            if (creditName) return creditName;
            
            // Sometimes it's under contributor-attributes (less common)
            return 'Unknown';
          })
          .filter(name => name !== 'Unknown') // remove unknowns if possible
          .join(', ');

        if (authors === '') authors = 'Unknown authors';
      }

      // --- Journal ---
      const journal = work['journal-title'] || '';

      html += `
        <li style="margin-bottom: 1.5em; padding-bottom: 1em; border-bottom: 1px solid #eee;">
          <strong><a href="${url}" target="_blank" rel="noopener">${title}</a></strong> (${year})<br>
          <em>${authors}</em>${journal ? `<br><small>${journal}</small>` : ''}
        </li>
      `;
      foundAny = true;
    });

    if (!foundAny) {
      container.innerHTML = '<p>No valid publications found.</p>';
    } else {
      html += '</ul>';
      container.innerHTML = html;
    }
  })
  .catch(err => {
    console.error('Publication loading error:', err);
    container.innerHTML = `<p>Failed to load publications.</p><p><small>${err.message}</small></p>`;
  });
}
</script>

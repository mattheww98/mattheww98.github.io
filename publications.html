---
layout: page
title: Publications
category: page
main_nav: true
permalink: /publications/
---

<div id="publications-list">
  <p>Loading publications from ORCID...</p>
</div>

<script>
const ORCID_ID = "0000-0001-8746-8754";
const container = document.getElementById('publications-list');

if (!ORCID_ID) {
  container.innerHTML = '<p>ORCID ID not configured in _config.yml</p>';
} else {
  fetch(`https://pub.orcid.org/v3.0/${ORCID_ID}/works`, {
    method: 'GET',
    headers: {
      'Accept': 'application/json'  // ✅ This is the key fix
    }
  })
  .then(response => {
    if (!response.ok) {
      throw new Error(`HTTP ${response.status}: ${response.statusText}`);
    }
    // Optional: log content type for debugging
    console.log('Content-Type:', response.headers.get('content-type'));
    return response.json();
  })
  .then(data => {
    // Now data should be a proper JSON object with .group array
    if (!data?.group || !Array.isArray(data.group)) {
      container.innerHTML = '<p>No publication groups found.</p>';
      return;
    }

    let html = '<ul style="list-style: none; padding-left: 0;">';
    let foundAny = false;

    data.group.forEach(group => {
      // In v3.0 JSON, each group has a "work-summary" array (not "works")
      if (!group?.['work-summary'] || !Array.isArray(group['work-summary']) || group['work-summary'].length === 0) {
        return;
      }

      const work = group['work-summary'][0]; // ✅ Correct field name in JSON

      const title = work.title?.title?.value || 'Untitled';
      const year = work['publication-date']?.year?.value || 'n.d.';
      const url = work.url || '#';
      
      let authors = 'Unknown authors';
      if (work.contributors?.contributor) {
        authors = work.contributors.contributor
          .map(c => c.contributor?.credit_name?.value || 'Unknown')
          .join(', ');
      }

      const journal = work['journal-title'] || '';

      html += `
        <li style="margin-bottom: 1.5em; padding-bottom: 1em; border-bottom: 1px solid #eee;">
          <strong><a href="${url}" target="_blank" rel="noopener">${title}</a></strong> (${year})<br>
          <em>${authors}</em>${journal ? `<br><small>${journal}</small>` : ''}
        </li>
      `;
      foundAny = true;
    });

    if (!foundAny) {
      container.innerHTML = '<p>No valid publications found.</p>';
    } else {
      html += '</ul>';
      container.innerHTML = html;
    }
  })
  .catch(err => {
    console.error('Publication loading error:', err);
    container.innerHTML = `
      <p>Failed to load publications.</p>
      <p><small>Error: ${err.message}</small></p>
    `;
  });
}
</script>
